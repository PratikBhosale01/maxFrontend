<app-loader *ngIf="loader"></app-loader>

<div class="newContainer">

  <section class="dashboard-cards">
    <div class="dashboard-card" (click)="openLastWeekDialog()">
      <div class="dashboard-card-content">
        <div class="dashboard-card-title">Last Week Deposit</div>
        <div class="dashboard-card-value">{{ lastWeekdepositCounts | number:'1.0-0' }}</div>
        <div class="dashboard-card-meta">{{ lastWeekdeposit | currency:'INR':'symbol':'1.0-0' }}</div>
      </div>
    </div>
    <div class="dashboard-card" (click)="openTodaysDepositeDialog()">
      <div class="dashboard-card-content">
        <div class="dashboard-card-title">Today's Deposited</div>
        <div class="dashboard-card-value">{{ todayCounts | number:'1.0-0' }}</div>
        <div class="dashboard-card-meta">{{ todaydeposit | currency:'INR':'symbol':'1.0-0' }}</div>
      </div>
    </div>
    <div style="display:flex; justify-content: space-between; width:100%;">
  
                <button class="btn btn--secondary action-btn" (click)="openTotalDepositeDialog()">
                    <i class="fas fa-chart-bar"></i>
                    Check Report
                </button>
                <button class="btn btn--secondary action-btn"  (click)="openTotalDepositeDialog()">
                    <i class="fas fa-coins"></i>
                    Total Deposit
                </button>
                <button class="btn btn--secondary action-btn" (click)="openDialog()">
                    <i class="fas fa-plus"></i>
                    Add New Deposit
                </button>   
    </div>
  
  </section>

    </div>

    <!-- <div class="date-filter-section">

      <mat-form-field appearance="fill" class="date-picker">
        <mat-label>From Date</mat-label>
        <input matInput [matDatepicker]="pickerFrom" [(ngModel)]="filterFromDate" (dateChange)="applyFilters()" />
        <mat-datepicker-toggle matSuffix [for]="pickerFrom"></mat-datepicker-toggle>
        <mat-datepicker #pickerFrom></mat-datepicker>
      </mat-form-field>

      <mat-form-field appearance="fill" class="date-picker">
        <mat-label>To Date</mat-label>
        <input matInput [matDatepicker]="pickerTo" [(ngModel)]="filterToDate" (dateChange)="applyFilters()" />
        <mat-datepicker-toggle matSuffix [for]="pickerTo"></mat-datepicker-toggle>
        <mat-datepicker #pickerTo></mat-datepicker>
      </mat-form-field>

      <button mat-raised-button color="primary" (click)="applyFilters()">Apply Filter</button>

      <button mat-button (click)="quickFilter('today')">Today</button>
      <button mat-button (click)="quickFilter('week')">This Week</button>
      <button mat-button (click)="quickFilter('month')">This Month</button>

    </div> -->
 <div class="date-filter-section">
  <div class="search-group">
          <input type="text" id="searchInput" class="form-control search-input" placeholder="Search by username..." [(ngModel)]="searchTerm" (input)="applyFilters()">
          <i class="fas fa-search search-icon"></i>
           </div>         
                <div class="date-inputs">
              <div class="date-group">
                <label for="fromDate">From Date</label>
                <input type="date" id="fromDate" class="form-control date-input" [(ngModel)]="filterFromDate" (change)="applyDateFilter()">
              </div>
              <div class="date-group">
                <label for="toDate">To Date</label>
                <input type="date" id="toDate" class="form-control date-input" [(ngModel)]="filterToDate" (change)="applyDateFilter()">
              </div>
              <button id="applyFilter" class="btn btn--primary" (click)="applyDateFilter()">
                <i class="fas fa-filter"></i>
                Apply Filter
              </button>
                </div>
        <div class="quick-filters">
          <button class="btn btn--outline quick-filter" [class.active]="activeQuickFilter === 'today'" (click)="quickFilter('today')">Today</button>
          <button class="btn btn--outline quick-filter" [class.active]="activeQuickFilter === 'week'" (click)="quickFilter('week')">This Week</button>
          <button class="btn btn--outline quick-filter" [class.active]="activeQuickFilter === 'month'" (click)="quickFilter('month')">This Month</button>
        </div>
            </div>


  

<div class="custom-table-container" id="custom-table-container">
  <mat-table matSort [dataSource]="filteredDataSource" class="custom-mat-table" matSortDisableClear>

    <ng-container matColumnDef="position">
      <mat-header-cell *matHeaderCellDef mat-sort-header>No.</mat-header-cell>
      <mat-cell *matCellDef="let element; let i = index">{{ i + 1 }}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="userId">
      <mat-header-cell *matHeaderCellDef mat-sort-header>Username</mat-header-cell>
      <mat-cell *matCellDef="let element">{{ element.userId }}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="approved">
      <mat-header-cell *matHeaderCellDef mat-sort-header>Approved</mat-header-cell>
      <mat-cell *matCellDef="let element">{{ element.approved }}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="rejected">
      <mat-header-cell *matHeaderCellDef mat-sort-header>Rejected</mat-header-cell>
      <mat-cell *matCellDef="let element">{{ element.rejected }}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="count">
      <mat-header-cell *matHeaderCellDef mat-sort-header>Deposits</mat-header-cell>
      <mat-cell *matCellDef="let element">{{ element.count }}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="amount">
      <mat-header-cell *matHeaderCellDef mat-sort-header>Amount</mat-header-cell>
      <mat-cell *matCellDef="let element">{{ element.amount | currency:'INR':'symbol':'1.0-0' }}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="date">
      <mat-header-cell *matHeaderCellDef mat-sort-header>Date</mat-header-cell>
      <mat-cell *matCellDef="let element">{{ element.date | date: 'mediumDate' }}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="status">
      <mat-header-cell *matHeaderCellDef mat-sort-header>Status</mat-header-cell>
      <mat-cell *matCellDef="let element">
        <span [ngClass]="statusClass(element.status)">{{ element.status }}</span>
      </mat-cell>
    </ng-container>

    <ng-container matColumnDef="actions">
      <mat-header-cell *matHeaderCellDef>Actions</mat-header-cell>
      <mat-cell *matCellDef="let element">
        <button mat-icon-button color="primary" (click)="viewDeposit(element)">
          <mat-icon>visibility</mat-icon>
        </button>
        <button mat-icon-button color="accent" (click)="editDeposit(element)">
          <mat-icon>edit</mat-icon>
        </button>
        <button mat-icon-button color="warn" (click)="deleteDeposit(element)">
          <mat-icon>delete</mat-icon>
        </button>
      </mat-cell>
    </ng-container>

    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
    <mat-row *matRowDef="let row; columns: displayedColumns" (click)="viewDeposit(row)" class="pointer"></mat-row>
  </mat-table>

  <!-- <mat-paginator [length]="filteredDataSource.length" [pageSize]="5" (page)="pageEvent($event)" showFirstLastButtons></mat-paginator> -->
</div>
